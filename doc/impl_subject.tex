\section{Subject}
Subjects are the main components that are executed on top of the kernel, as
described in section TODO:Ref. They are represented using two main data
structures: \emph{subject specification} and \emph{subject state}.

\subsection{Specification}
A subjects is specified in the global system policy. As described in the
previous section TODO:Ref, the XML specification precisely defines the execution
environment and granted resources. The information that is relevant to the
kernel is part of the compiled policy. Listing \ref{lst:skp-subjects} presents
the SPARK type specification into which all relevant subject policy parts are
transformed.

\lstinputlisting[
	language=ada,
	linerange={14-33},
	label=lst:skp-subjects,
	caption=SPARK subject spec type]
	{../tools/policy/templates/skp-subjects.adb}

The specification of a subject is static and cannot be changed at runtime.

\subsection{State}
The system state related to a subject must encompass all resources, that it can
control directly or indirectly. This is necessary to enable the scheduler to
preempt a subject by preserving its state and seamlessly resume execution at a
later stage by restoring the previously saved state.
Additionally, separation of subjects demands that unintended information flows
when switching between subjects must be prevented. This is only achievable if
the subject state that is saved and restored encompasses every element of the
systems environment that is accessible by more than one subject. Listing
\ref{lst:sk-subject-state} shows the record type used by ther Kernel to maintain
the state of a subject.

\lstinputlisting[
	language=ada,
	linerange={40-56},
	label=lst:sk-subject-state,
	caption=SPARK subject state type]
	{../common/src/sk.ads}

A special monitoring subject called \emph{subject monitor}
\index{subject monitor} (SM) may be given access to parts or the entire state of
a given subject. This enables the SM to alter a subject's state given the right
conditions and thus perform emulation.
