<?xml version="1.0"?>
<!DOCTYPE system [
<!ENTITY hardware   SYSTEM "hardware/__HARDWARE__.xml">
<!ENTITY kernel     SYSTEM "example_kernel.xml">
<!ENTITY binaries   SYSTEM "example_binaries.xml">
<!ENTITY scheduling SYSTEM "example_scheduling.xml">
<!ENTITY tau0init   SYSTEM "tau0.xml">
<!ENTITY tau0mem    SYSTEM "tau0_mem.xml">
<!ENTITY vtinit     SYSTEM "vt.xml">
<!ENTITY vtmem      SYSTEM "vt_mem.xml">
<!ENTITY idleinit   SYSTEM "idle.xml">
<!ENTITY idlemem    SYSTEM "idle_mem.xml">
<!ENTITY sminit     SYSTEM "sm.xml">
<!ENTITY smmem      SYSTEM "sm_mem.xml">
<!ENTITY xv6init    SYSTEM "xv6.xml">
<!ENTITY xv6mem     SYSTEM "xv6_mem.xml">
]>
<system vmxon_address="1000" vmcs_start_address="5000">
	&hardware;
	&kernel;
	&binaries;

	<subjects>
		<subject id="0" name="tau0" profile="native" cpu="3" pml4_address="210000" io_bitmap_address="214000" msr_bitmap_address="216000">
			&tau0init;
			<memory_layout>
				&tau0mem;
				<!-- Ï„0 => kernel interface page -->
				<memory_region physical_address="1ff000" virtual_address="4000" size="4k" alignment="4k" writable="true"  executable="false" memory_type="UC"/>
			</memory_layout>
			<binary name="tau0" physical_address="217000"/>
		</subject>

		<subject id="1" name="vt" profile="native" cpu="0" pml4_address="290000" io_bitmap_address="294000" msr_bitmap_address="296000">
			&vtinit;
			<memory_layout>
				&vtmem;
				<!-- virtual terminal console 6 -->
				<memory_region physical_address="300000" virtual_address="b9000" size="4k" alignment="4k" writable="true" executable="false" memory_type="UC"/>

				<!-- virtual terminals 1-6      -->
				<memory_region physical_address="260000" virtual_address="10000" size="4k" alignment="4k" writable="false" executable="false" memory_type="UC"/>
				<memory_region physical_address="280000" virtual_address="11000" size="4k" alignment="4k" writable="false" executable="false" memory_type="UC"/>
				<memory_region physical_address="242000" virtual_address="12000" size="4k" alignment="4k" writable="false" executable="false" memory_type="UC"/>
				<memory_region physical_address="517000" virtual_address="13000" size="4k" alignment="4k" writable="false" executable="false" memory_type="UC"/>
				<memory_region physical_address="342000" virtual_address="14000" size="4k" alignment="4k" writable="false" executable="false" memory_type="UC"/>
				<memory_region physical_address="300000" virtual_address="15000" size="4k" alignment="4k" writable="false" executable="false" memory_type="UC"/>

				<!-- Xv6 driver page            -->
				<memory_region physical_address="518000" virtual_address="20000" size="4k" alignment="4k" writable="true" executable="false" memory_type="WB"/>
			</memory_layout>
			<binary name="vt" physical_address="297000"/>
			<device name="vga"/>
			<device name="cursor"/>
			<device name="keyboard"/>
			<event_table>
				<interrupt event="1" dst_subject="xv6" dst_vector="33" send_ipi="true"/>
			</event_table>
			<msr start="802" end="802" mode="r"/>
		</subject>

		<subject id="2" name="idle" profile="native" cpu="2" pml4_address="310000" io_bitmap_address="314000" msr_bitmap_address="316000">
			&idleinit;
			<memory_layout>
				&idlemem;
			</memory_layout>
			<binary name="idle" physical_address="317000"/>
		</subject>

		<subject id="3" name="sm" profile="native" cpu="1" pml4_address="330000" io_bitmap_address="334000" msr_bitmap_address="336000">
			&sminit;
			<memory_layout>
				&smmem;
				<!-- subject state descriptors  -->
				<memory_region physical_address="1fe000" virtual_address="1fe000" size="4k" alignment="4k" writable="true" executable="false" memory_type="UC"/>
				<!-- virtual terminal console 5 -->
				<memory_region physical_address="342000" virtual_address="b8000" size="4k" alignment="4k" writable="true" executable="false" memory_type="UC"/>
			</memory_layout>
			<binary name="sm" physical_address="337000"/>
			<event_table>
				<handover event="4" dst_subject="xv6"/>
			</event_table>
		</subject>

		<subject id="4" name="xv6" profile="vm" cpu="1" pml4_address="500000" io_bitmap_address="504000" msr_bitmap_address="506000">
			&xv6init;
			<memory_layout>
				&xv6mem;
				<!-- virtual terminal console 4         -->
				<memory_region physical_address="517000" virtual_address="b8000" size="4k" alignment="4k" writable="true" executable="false" memory_type="UC"/>
				<!-- driver page shared with vt subject -->
				<memory_region physical_address="518000" virtual_address="90000" size="1M" alignment="4k" writable="true" executable="true" memory_type="WB"/>
			</memory_layout>
			<binary name="xv6" physical_address="507000"/>
			<device name="cursor"/>
			<trap_table>
				<entry kind="*" dst_subject="sm" dst_vector="36"/>
			</trap_table>
		</subject>
	</subjects>

	&scheduling;
</system>
