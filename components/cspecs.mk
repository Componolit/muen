CSPEC_XML     = $(wildcard spec/$(COMPONENT).xml)
CSPEC_INSTALL = $(POLICY_CSPEC_DIR)/$(COMPONENT).xml
CSPEC_HAS_BIN = $(wildcard $(OBJ_DIR)/$(COMPONENT))

DUMMY := $(shell mkdir -p $(POLICY_CSPEC_DIR))

ifneq ($(CSPEC_XML),)
INSTALL_TARGETS += $(CSPEC_INSTALL)
CSPEC_XML_GEN    = $(wildcard $(GEN_DIR)/$(COMPONENT).xml)
ifneq ($(CSPEC_XML_GEN),)
CSPEC_XML = $(CSPEC_XML_GEN)
endif
CSPEC_INST_CMD  = cp $(CSPEC_XML) $(CSPEC_INSTALL)
CSPEC_INST_DEPS = $(CSPEC_XML)
ifneq ($(CSPEC_HAS_BIN),)
CSPEC_INST_CMD   = $(MUCBINSPLIT) -i $(CSPEC_XML) -b $(OBJ_DIR)/$(COMPONENT) -o $(CSPEC_INSTALL) $(POLICY_OBJ_DIR)
CSPEC_INST_DEPS += $(MUCBINSPLIT) $(OBJ_DIR)/$(COMPONENT)
endif
endif

cspecs: $(GEN_DIR)/$(COMPONENT).xml
$(GEN_DIR)/$(COMPONENT).xml: spec/$(COMPONENT).xml $(MUCGENSPEC) $(CSPEC_TARGETS)
	$(MUCGENSPEC) -i $< -o $@ -I $(GEN_DIR) $(GEN_DIR)

$(CSPEC_INSTALL): $(CSPEC_INST_DEPS)
	$(CSPEC_INST_CMD)
